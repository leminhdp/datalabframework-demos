---
run: default
providers:
    local_filesystem:
        service: local
        path: data
        format: csv
    elastic_test:
        service: elastic
        hostname: 123.31.32.226
        port: 9200
resources:
    keywords:
        path: keywords.csv
        provider: local_filesystem
        read:
            options:
                header: True
                inferSchema: True
    keywords_search:
        privider: elastic_test
        #index: search_keywords_dev
        path: /product_catalog_dev/_search
        query: >
            {
                "query": {
                    "match_all": {}
                }
            }
            
    keywords_elk:
        provider: elastic_test
        index: search_keywords_dev
        settings: >
            {
                "index": {
                    "number_of_shards": 1,
                    "number_of_replicas": 2,
                    "mapping": {
                        "total_fields": {
                            "limit": "100000"
                        }
                    }
                }
            }
        mappings: 
            doc_type: keyword 
            properties: >
                {
                    "api_result": {
                        "type": "double"
                    },
                    "count": {
                        "type": "integer"
                    },
                    "gg": {
                        "type": "integer"
                    },
                    "gg_clicks": {
                        "type": "double"
                    },
                    "gg_impressions": {
                        "type": "double"
                    },
                    "gg_position": {
                        "type": "double"
                    },
                    "pv": {
                        "type": "integer"
                    },
                    "pv_impressions": {
                        "type": "double"
                    },
                    "pv_position": {
                        "type": "double"
                    },
                    "pv_result": {
                        "type": "double"
                    },
                    "query": {
                        "type": "text",
                        "fields": {
                            "keyword": {
                                "type": "keyword",
                                "ignore_above": 256
                            }
                        }
                    },
                    "query_wo_tones": {
                        "type": "text",
                        "fields": {
                            "keyword": {
                                "type": "keyword",
                                "ignore_above": 256
                            }
                        }
                    }
                }
                

engines:
    spark-local:
        context: spark
        config:
            master: local[*]
            jobname: 'default'
    elastic:
        context: elastic

loggers:
    stream:
        enable: true
        severity: info
